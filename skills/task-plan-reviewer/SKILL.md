---
name: task-plan-reviewer
description: 评估任务规划文档的合理性，检查模块拆分、依赖关系、执行顺序等方面的问题，输出结构化的评审报告。当用户要求"评审任务计划"、"检查规划质量"、"验证依赖"、"评估可行性"，或提到"计划审查"、"架构评估"时使用。也响应 "review task plan", "evaluate planning quality", "check task structure"。
---

# Task Plan Reviewer

任务规划评审：LOAD → REVIEW → AGGREGATE → SCORE → REPORT

---

## 🚀 执行流程

**当此 skill 被触发时，你必须按以下流程执行：**

### 立即行动

1. 定位任务规划文档（`.tasks/{task-name}/`）
2. 验证文档存在且格式正确
3. 开始 Phase 1: LOAD

### 📋 进度追踪 Checklist

**复制此清单并逐项完成：**

```
- [ ] Phase 1: LOAD → 读取并解析规划文档
- [ ] Phase 2: REVIEW → 六维度审查
- [ ] Phase 3: AGGREGATE → 问题汇总和分类
- [ ] Phase 4: SCORE → 计算评分和等级
- [ ] Phase 5: REPORT → 输出评审报告
```

### ✅ 阶段完成验证

| 阶段 | 完成条件 | 下一步 |
|------|----------|--------|
| LOAD | 文档模型已构建 | → REVIEW |
| REVIEW | 六维度审查完成 | → AGGREGATE |
| AGGREGATE | 问题已分类 | → SCORE |
| SCORE | 评分已计算 | → REPORT |
| REPORT | 评审报告已输出 | → 结束 |

---

## Phase 详情

### Phase 1: LOAD（加载文档）

**你必须：**
1. 读取 `.tasks/{task-name}/` 下所有文档
2. 解析 main-plan.md、tasks.md、module-*.md
3. 构建文档结构模型
4. 提取模块、任务、依赖关系

**完成标志**: 文档模型已构建

---

### Phase 2: REVIEW（六维度审查）

**你必须：**
按以下六个维度逐一审查：

| 维度 | 权重 | 检查项 |
|------|------|--------|
| 架构 | 20% | 单一职责、模块粒度(3-7个)、边界清晰、无重叠 |
| 依赖 | 20% | 循环依赖检测、依赖方向、完整性、耦合度(≤3) |
| 执行顺序 | 15% | 阶段顺序、步骤依赖、并行合理、关键路径 |
| 任务完整性 | 20% | 需求覆盖、任务粒度(30min-8h)、验收标准、优先级 |
| 文档质量 | 15% | 视角正确、详细度、图表质量、链接有效 |
| 风险评估 | 10% | 技术风险、依赖风险、应对策略 |

**完成标志**: 六维度审查完成

---

### Phase 3: AGGREGATE（问题汇总）

**你必须：**
1. 收集所有发现的问题
2. 按严重程度分类：
   - **Critical**: 必须修复，否则无法执行
   - **Major**: 建议修复，影响效率/质量
   - **Minor**: 可选优化，提升文档质量
3. 按维度归类问题

**完成标志**: 问题已分类

---

### Phase 4: SCORE（计算评分）

**你必须：**
1. 按权重计算各维度得分
2. 计算加权总分
3. 确定等级：

| 分数范围 | 等级 | 行动建议 |
|----------|------|----------|
| 90-100 | 优秀 | 可直接执行 |
| 80-89 | 良好 | 建议优化后执行 |
| 70-79 | 合格 | 需要优化后执行 |
| 60-69 | 待改进 | 必须修复主要问题 |
| <60 | 不通过 | 需重新规划 |

**完成标志**: 评分已计算

---

### Phase 5: REPORT（输出报告）

**你必须：**
1. **评审概览**：总分、等级、各维度得分、结论
2. **Critical 问题**：必须修复的问题及建议
3. **Major 问题**：建议修复的问题及建议
4. **Minor 问题**：可选优化清单
5. **详细评审**：各维度详细发现
6. **改进摘要**：P0/P1/P2 优先级建议

**完成标志**: 评审报告已输出

---

## 问题严重程度

| 级别 | 定义 | 示例 |
|------|------|------|
| Critical | 阻塞执行 | 循环依赖、顺序冲突 |
| Major | 影响质量 | 需求遗漏、边界模糊 |
| Minor | 可选优化 | 格式问题、链接失效 |

---

## 最佳实践

1. 执行前审查（发现问题成本最低）
2. 修复问题后重新审查
3. 人工复核 Critical 问题的修复建议
4. 重点关注依赖和执行顺序（影响最大）
5. 在版本控制中保留审查历史
